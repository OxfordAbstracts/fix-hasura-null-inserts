// Generated by purs version 0.15.7
import * as Control_Alt from "../Control.Alt/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Plus from "../Control.Plus/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Functor_Variant from "../Data.Functor.Variant/index.js";
import * as Run from "../Run/index.js";
import * as Run_Internal from "../Run.Internal/index.js";
import * as Type_Equality from "../Type.Equality/index.js";
var chooseIsSymbol = {
    reflectSymbol: function () {
        return "choose";
    }
};
var on = /* #__PURE__ */ Data_Functor_Variant.on()(chooseIsSymbol);
var pure = /* #__PURE__ */ Control_Applicative.pure(Run.applicativeRun);
var bind = /* #__PURE__ */ Control_Bind.bind(Run.bindRun);
var runChoose = function (dictAlternative) {
    var Plus1 = dictAlternative.Plus1();
    var empty = Control_Plus.empty(Plus1);
    var alt = Control_Alt.alt(Plus1.Alt0());
    var pure1 = Control_Applicative.pure(dictAlternative.Applicative0());
    var handle = on(Run_Internal["_choose"])(Data_Either.Left.create)(Data_Either.Right.create);
    var loop = function (r) {
        var v = Run.peel(r);
        if (v instanceof Data_Either.Left) {
            var v1 = handle(v.value0);
            if (v1 instanceof Data_Either.Left) {
                if (v1.value0 instanceof Run_Internal.Empty) {
                    return pure(empty);
                };
                if (v1.value0 instanceof Run_Internal.Alt) {
                    return bind(loop(v1.value0.value0(true)))(function (x) {
                        return bind(loop(v1.value0.value0(false)))(function (y) {
                            return pure(alt(x)(y));
                        });
                    });
                };
                throw new Error("Failed pattern match at Run.Choose (line 33, column 18 - line 38, column 25): " + [ v1.value0.constructor.name ]);
            };
            if (v1 instanceof Data_Either.Right) {
                return bind(Run.send(v1.value0))(loop);
            };
            throw new Error("Failed pattern match at Run.Choose (line 32, column 15 - line 40, column 29): " + [ v1.constructor.name ]);
        };
        if (v instanceof Data_Either.Right) {
            return pure(pure1(v.value0));
        };
        throw new Error("Failed pattern match at Run.Choose (line 31, column 12 - line 42, column 20): " + [ v.constructor.name ]);
    };
    return loop;
};
var liftChoose = /* #__PURE__ */ Run.lift()(chooseIsSymbol)(Run_Internal.functorChoose)(Run_Internal["_choose"]);
var cempty = /* #__PURE__ */ Control_Plus.empty(/* #__PURE__ */ Run.runPlus(Type_Equality.refl));
var calt = /* #__PURE__ */ Control_Alt.alt(/* #__PURE__ */ Run.runAlt(Type_Equality.refl));
export {
    liftChoose,
    cempty,
    calt,
    runChoose
};
export {
    Alt,
    Empty,
    _choose
} from "../Run.Internal/index.js";
